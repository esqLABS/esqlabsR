<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="esqlabsR">
<title>4. Plot Results • esqlabsR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="4. Plot Results">
<meta property="og:description" content="esqlabsR">
<meta property="og:image" content="https://esqlabs.github.io/esqlabsR/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">esqlabsR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">5.1.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/esqlabsR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>esqlabsR Workflow</h6>
    <a class="dropdown-item" href="../articles/esqlabsR-workflow-overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/esqlabsR-project-structure.html">1. Initialize a Project</a>
    <a class="dropdown-item" href="../articles/esqlabsR-design-scenarios.html">2. Design Scenarios</a>
    <a class="dropdown-item" href="../articles/esqlabsR-run-simulations.html">3. Run Simulations</a>
    <a class="dropdown-item" href="../articles/esqlabsR-plot-results.html">4. Plot Results</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6>
    <a class="dropdown-item" href="../articles/esqlabsR-sensitivity.html">Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/esqlabsR-shiny.html">esqlabsR Applications</a>
    <a class="dropdown-item" href="../articles/esqlabsR-advanced.html">Advanced Topics</a>
    <a class="dropdown-item" href="../articles/presentations.html">Presentations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/esqLABS/esqlabsR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>4. Plot Results</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/esqLABS/esqlabsR/blob/HEAD/vignettes/esqlabsR-plot-results.Rmd" class="external-link"><code>vignettes/esqlabsR-plot-results.Rmd</code></a></small>
      <div class="d-none name"><code>esqlabsR-plot-results.Rmd</code></div>
    </div>

    
    
<p>Plotting the simulation results is an integral part of model
diagnostics and quality control. <a href="https://github.com/esqLABS/esqlabsR" class="external-link">esqlabsR</a> implements an
excel-based <a href="#plotting-workflow">Plotting Workflow</a> for
figure creation directly from simulated scenarios. It is also possible
to use <a href="https://github.com/esqLABS/esqlabsR" class="external-link">esqlabsR</a>’s functions to <a href="#plotting-with-code">plot using R code</a>.</p>
<div class="section level2">
<h2 id="plotting-workflow">Plotting Workflow<a class="anchor" aria-label="anchor" href="#plotting-workflow"></a>
</h2>
<p>This process relies on filling a
<strong><code>Plots.xlsx</code></strong> file in order to specify all
the figures that need to be created. Then,
<code><a href="../reference/createPlotsFromExcel.html">createPlotsFromExcel()</a></code> will translate the information in
the excel file into plots !</p>
<p>First, <code>DataCombined</code> are defined with simulation results
coming from simulated scenarios and observed data sets in the
<strong>DataCombined</strong> sheet. More information in the <a href="#specify-a-datacombined">Create a Datacombined</a> section.</p>
<p>From each <code>DataCombined</code>, multiple plots of different
types can be defined using the <strong>plotConfiguration</strong> sheet.
More information in the <a href="#customizing-plots">Customizing
Plots</a> section.</p>
<p>Each plot to draw is defined in a <strong>plotGrid</strong> which is
specified in the <strong>plotGrids</strong> sheet. A
<strong>plotGrid</strong> can contain one or several plots defined in
the plotConfiguration sheet and has many options to customize the layout
of the plots. More information in the <a href="#drawing-plots">Drawing
Plots</a> section.</p>
<p>plotGrids export options like size, quality, file type etc… are
available in the <strong>exportConfiguration</strong> sheet. More
information in the <a href="#export-plots">Export Plot</a> section.</p>
<p>Once all the excel sheets are setup, just call the
<code><a href="../reference/createPlotsFromExcel.html">createPlotsFromExcel()</a></code> function to generate and export the
plots.</p>
<p><img src="Figures/plot-workflow.png"></p>
<div class="section level3">
<h3 id="specify-a-datacombined">Specify a <code>DataCombined</code><a class="anchor" aria-label="anchor" href="#specify-a-datacombined"></a>
</h3>
<p>A <code>DataCombined</code> is where the data to plot is stored. It
can contain simulated results and/or observed data and links them
together.</p>
<p>First, the user needs to define the name of the dataCombined. The
name need to be stored in the <code>DataCombinedName</code>. Then, for
each <code>DataCombinedName</code>, the user can attach simulated
results (set dataType to <code>simulated</code>) and observed data (set
dataType to <code>observed</code>) and give them labels. For Simulated
results, the user needs to specify the name of the scenario and the
output path of the simulation. For observed data, the user needs to
specify the name of the dataset to use. Finally, both type of data can
be linked together if they share the same value in the
<code>groups</code> column.</p>
<p>Other columns available in this sheet are relative to the data
transformations that can be performed by <code>dataCombined</code>. For
more information on this, please refer to the <a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a>
documentation about it <a href="https://www.open-systems-pharmacology.org/OSPSuite-R/articles/data-combined.html#transformations" class="external-link">here</a>.</p>
</div>
<div class="section level3">
<h3 id="customizing-plots">Customizing Plots<a class="anchor" aria-label="anchor" href="#customizing-plots"></a>
</h3>
<p>The default <code>Plot.xlsx</code> file already contains the most
common columns required to customize plots. However, the user can add
all the necessary columns that are needed to reach the desired result.
The list of available variables can be explored in a
<code>defaultPlotConfiguration</code> object.</p>
<p>Here is a sample of the available plot settings:</p>
<pre><code><span><span class="co">#&gt;  [1] "foldLinesLegendDiagonal" "foldLinesLegend"        </span></span>
<span><span class="co">#&gt;  [3] "lloqDirection"           "displayLLOQ"            </span></span>
<span><span class="co">#&gt;  [5] "errorbarsAlpha"          "errorbarsLinetype"      </span></span>
<span><span class="co">#&gt;  [7] "errorbarsCapSize"        "errorbarsSize"          </span></span>
<span><span class="co">#&gt;  [9] "ribbonsAlpha"            "ribbonsLinetype"        </span></span>
<span><span class="co">#&gt; [11] "ribbonsSize"             "ribbonsFill"            </span></span>
<span><span class="co">#&gt; [13] "pointsAlpha"             "pointsSize"             </span></span>
<span><span class="co">#&gt; [15] "pointsShape"</span></span></code></pre>
<p>You can access the full list by running
<code>DefaultPlotConfiguration$new()</code></p>
<p>For instance, if the subtitle needs to be changed, the user can add a
column named <code>subtitle</code> and fill it with the desired value
for each plot.</p>
<p>Leaving a cell empty will result in the default value being used.</p>
<p>For properties that accept a list of values
(e.g. <code>xAxisLimits</code>), the values should be separated by a
<code>,</code>. If an entry itself contains a <code>,</code>, enclose it
between parenthesis.</p>
</div>
<div class="section level3">
<h3 id="drawing-plots">Drawing Plots<a class="anchor" aria-label="anchor" href="#drawing-plots"></a>
</h3>
<p><code>plotGrids</code> are the objects that will be used to draw the
plots. They are defined in the <strong>plotGrids</strong> sheet. The
user needs to define a name for each plotGrid. For single panel plot,
only one plot must be listed in the plotIDs column.
<a href="https://github.com/esqLABS/esqlabsR" class="external-link">esqlabsR</a> also provide a simple way to combined several
plots in a multi-panel figure, in this case, the user needs to list all
the plotIDs to combine in the plotIDs column, separated by a
<code>,</code>.</p>
<p>To customize the plotGrid, the user can add all the necessary columns
that are defined in the <code>PlotGridConfiguration</code> class. Here
is a sample of the available:</p>
<pre><code><span><span class="co">#&gt;  [1] "tagMargin"                  "tagLineHeight"             </span></span>
<span><span class="co">#&gt;  [3] "tagAngle"                   "tagVerticalJustification"  </span></span>
<span><span class="co">#&gt;  [5] "tagHorizontalJustification" "tagFontFamily"             </span></span>
<span><span class="co">#&gt;  [7] "tagFontFace"                "tagSize"                   </span></span>
<span><span class="co">#&gt;  [9] "tagColor"                   "tagPosition"               </span></span>
<span><span class="co">#&gt; [11] "tagSeparator"               "tagSuffix"                 </span></span>
<span><span class="co">#&gt; [13] "tagPrefix"                  "tagLevels"                 </span></span>
<span><span class="co">#&gt; [15] "design"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="export-plots">Export Plots<a class="anchor" aria-label="anchor" href="#export-plots"></a>
</h3>
<p>In order to export plots to image files, the user can use the
<strong>exportConfiguration</strong> sheet. The plotGrids to export must
be added in the plotGridName column. Then, the output file name must be
specified in the outputName column. The output format can be customize
using the properties listed in the <code>ExportConfiguration</code>
class. Here is a sample of the available:</p>
<pre><code><span><span class="co">#&gt; [1] "heightPerRow" "dpi"          "units"        "height"       "width"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="plotting-workflow-example">Plotting Workflow Example<a class="anchor" aria-label="anchor" href="#plotting-workflow-example"></a>
</h3>
<div class="section level4">
<h4 id="example-scenario">Example Scenario<a class="anchor" aria-label="anchor" href="#example-scenario"></a>
</h4>
<p>For the following examples, we will simulate an example scenario as
described in <code><a href="../articles/esqlabsR.html">vignette("esqlabsR")</a></code> and load the
corresponding observed data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/esqLABS/esqlabsR" class="external-link">esqlabsR</a></span><span class="op">)</span></span>
<span><span class="co"># Create a project configuration</span></span>
<span><span class="va">projectConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDefaultProjectConfiguration.html">createDefaultProjectConfiguration</a></span><span class="op">(</span><span class="fu"><a href="../reference/example_ProjectConfiguration.html">example_ProjectConfiguration</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Create `ScenarioConfiguration` objects from excel files</span></span>
<span><span class="va">scenarioConfigurations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readScenarioConfigurationFromExcel.html">readScenarioConfigurationFromExcel</a></span><span class="op">(</span></span>
<span>  scenarioNames <span class="op">=</span> <span class="st">"TestScenario"</span>,</span>
<span>  projectConfiguration <span class="op">=</span> <span class="va">projectConfiguration</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Run scenario configuration</span></span>
<span><span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createScenarios.html">createScenarios</a></span><span class="op">(</span>scenarioConfigurations <span class="op">=</span> <span class="va">scenarioConfigurations</span><span class="op">)</span></span>
<span><span class="va">simulatedScenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runScenarios.html">runScenarios</a></span><span class="op">(</span></span>
<span>  scenarios <span class="op">=</span> <span class="va">scenarios</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load observed data</span></span>
<span><span class="va">dataSheets</span> <span class="op">&lt;-</span> <span class="st">"Laskin 1982.Group A"</span></span>
<span><span class="va">observedData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadObservedData.html">loadObservedData</a></span><span class="op">(</span>projectConfiguration <span class="op">=</span> <span class="va">projectConfiguration</span>, sheets <span class="op">=</span> <span class="va">dataSheets</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="setup-the-plot-xlsx-file">Setup the <code>Plot.xlsx</code> file<a class="anchor" aria-label="anchor" href="#setup-the-plot-xlsx-file"></a>
</h4>
<p>Then, the <code>Plot.xlsx</code> file is setup to define the
<code>DataCombined</code>, customize plots, specify plotGrids and export
options. The <code>Plot.xlsx</code> file used in this example can be
found <a href="https://github.com/esqLABS/esqlabsR/raw/main/inst/extdata/examples/TestProject/Parameters/Plots.xlsx" class="external-link">here</a>.</p>
</div>
<div class="section level4">
<h4 id="use-createplotsfromexcel">use <code>createPlotsFromExcel()</code><a class="anchor" aria-label="anchor" href="#use-createplotsfromexcel"></a>
</h4>
<p>In the next step, the user calls the function
<code><a href="../reference/createPlotsFromExcel.html">createPlotsFromExcel()</a></code>, passing the generated data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPlotsFromExcel.html">createPlotsFromExcel</a></span><span class="op">(</span>simulatedScenarios <span class="op">=</span> <span class="va">simulatedScenarios</span>,</span>
<span>                              observedData <span class="op">=</span> <span class="va">observedData</span>,</span>
<span>                              projectConfiguration <span class="op">=</span> <span class="va">projectConfiguration</span><span class="op">)</span></span></code></pre></div>
<p>The function returns a named list of <code>ggplot2</code> objects,
with names being the names of the plot grids:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Aciclovir"  "Aciclovir2"</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">Aciclovir</span></span></code></pre></div>
<p><img src="esqlabsR-plot-results_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">Aciclovir2</span></span></code></pre></div>
<p><img src="esqlabsR-plot-results_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>Also, calling this function will export the plots as image files if
the exportConfiguration sheet is setup correctly.</p>
<p>By default, the function will try to create all plots defined in the
<strong>plotGrids</strong> sheet. If any of the simulation results or
the observed date required by these plots cannot be found, an error is
thrown. To override this behavior, e.g., to only plot the observed data
without having the results simulated, change the value of the argument
<code>stopIfNotFound</code> to <code>FALSE</code>. You can also specify
which plots to create with the <code>plotGridNames</code> argument.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="plotting-with-code">Plotting With Code<a class="anchor" aria-label="anchor" href="#plotting-with-code"></a>
</h2>
<p>In some situation, the user needs to quickly draw a plot from a
simulation result object using code while wanting to use the default
esqlabsR theme. In this situation, using the <code>Plots.xlsx</code>
file is not necessary. Instead, the user can directly use
<a href="https://github.com/esqLABS/esqlabsR" class="external-link">esqlabsR</a>’s and <a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a>’s plotting
functions to create the desired plot while preserving the
<a href="https://github.com/esqLABS/esqlabsR" class="external-link">esqlabsR</a> theme.</p>
<div class="section level3">
<h3 id="basics-of-figure-creation-with-ospsuite">Basics of figure creation with <code>{ospsuite}</code><a class="anchor" aria-label="anchor" href="#basics-of-figure-creation-with-ospsuite"></a>
</h3>
<p>Simulated modeling scenarios can be passed to plotting functions from
the <a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a> package to create uniformly-looking plots.
To get familiar with the <code>DataCombined</code> class used to store
matching observed and simulated data, read the <a href="https://www.open-systems-pharmacology.org/OSPSuite-R/dev/articles/data-combined.html" class="external-link">Working
with <code>DataCombined</code> class</a> article. The article <a href="https://www.open-systems-pharmacology.org/OSPSuite-R/dev/articles/data-combined-plotting.html" class="external-link">Visualizations
with <code>DataCombined</code></a> covers the basics of creating
supported plot types and how to customize them.</p>
</div>
<div class="section level3">
<h3 id="using-esqlabsr">Using esqlabsR<a class="anchor" aria-label="anchor" href="#using-esqlabsr"></a>
</h3>
<p>For the following examples, we will use the same scenario as
described in the <a href="#example">Example</a> above.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/esqLABS/esqlabsR" class="external-link">esqlabsR</a></span><span class="op">)</span></span>
<span><span class="co"># Create a project configuration</span></span>
<span><span class="va">projectConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDefaultProjectConfiguration.html">createDefaultProjectConfiguration</a></span><span class="op">(</span><span class="fu"><a href="../reference/example_ProjectConfiguration.html">example_ProjectConfiguration</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Create `ScenarioConfiguration` objects from excel files</span></span>
<span><span class="va">scenarioConfigurations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readScenarioConfigurationFromExcel.html">readScenarioConfigurationFromExcel</a></span><span class="op">(</span></span>
<span>  scenarioNames <span class="op">=</span> <span class="st">"TestScenario"</span>,</span>
<span>  projectConfiguration <span class="op">=</span> <span class="va">projectConfiguration</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Run scenario configuration</span></span>
<span><span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createScenarios.html">createScenarios</a></span><span class="op">(</span>scenarioConfigurations <span class="op">=</span> <span class="va">scenarioConfigurations</span><span class="op">)</span></span>
<span><span class="va">simulatedScenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runScenarios.html">runScenarios</a></span><span class="op">(</span></span>
<span>  scenarios <span class="op">=</span> <span class="va">scenarios</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load observed data</span></span>
<span><span class="va">dataSheets</span> <span class="op">&lt;-</span> <span class="st">"Laskin 1982.Group A"</span></span>
<span><span class="va">observedData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadObservedData.html">loadObservedData</a></span><span class="op">(</span>projectConfiguration <span class="op">=</span> <span class="va">projectConfiguration</span>, sheets <span class="op">=</span> <span class="va">dataSheets</span><span class="op">)</span></span></code></pre></div>
<p>For the following steps, no <code>Plots.xlsx</code> file is needed.
Instead, we will use the <code>DataCombined</code> class to store the
simulated and observed data, use the <a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a>’s plotting
functions to create the plots together with the <a href="https://github.com/esqLABS/esqlabsR" class="external-link">esqlabsR</a>
functions to customize the plots and their export.</p>
<div class="section level4">
<h4 id="create-a-datacombined-object">Create a <code>DataCombined</code> object<a class="anchor" aria-label="anchor" href="#create-a-datacombined-object"></a>
</h4>
<p>The simulation results are stored in a list returned by the
<code><a href="../reference/runScenarios.html">runScenarios()</a></code> function. Plotting and visualization are
performed by storing these results, matching observed data in a
<code>DataCombined</code> object, and passing it to plotting functions.
Observed data in the form of <code>DataSet</code> objects are added to a
<code>DataCombined</code> object via the <code>addDataSets()</code>
function, and simulated results can be added by using the
<code>addSimulationResults()</code> function. Observed and simulated
data can be linked by setting the <code>groups</code> argument in both
methods. Data sets of the same group will then be plotted together when
calling plotting functions on the <code>DataCombined</code> object.</p>
<p>Let’s create a <code>DataCombined</code> object and populate it with
data with the following code:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataCombined</span> <span class="op">&lt;-</span> <span class="va"><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/DataCombined.html" class="external-link">DataCombined</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dataCombined</span><span class="op">$</span><span class="fu">addDataSets</span><span class="op">(</span><span class="va">observedData</span>, names <span class="op">=</span> <span class="st">"Observed"</span>, groups <span class="op">=</span> <span class="st">"Aciclovir"</span><span class="op">)</span></span>
<span><span class="va">dataCombined</span><span class="op">$</span><span class="fu">addSimulationResults</span><span class="op">(</span><span class="va">simulatedScenarios</span><span class="op">$</span><span class="va">TestScenario</span><span class="op">$</span><span class="va">results</span>,</span>
<span>  names <span class="op">=</span> <span class="st">"Simulated"</span>,</span>
<span>  groups <span class="op">=</span> <span class="st">"Aciclovir"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can also return the <code>DataCombined</code> objects defined in
the <code>DataCombined</code> sheet with the function
<code><a href="../reference/createDataCombinedFromExcel.html">createDataCombinedFromExcel()</a></code>, read (this
section)[#specify-a-datacombined] for more information.</p>
</div>
<div class="section level4">
<h4 id="customize-and-generate-plots">Customize and generate plots<a class="anchor" aria-label="anchor" href="#customize-and-generate-plots"></a>
</h4>
<p>Customization of the generated figures - specifying title, axes
ranges, axes units, the position of the legend, etc., are done through
<em>plot configurations</em> - objects of the class <a href="https://www.open-systems-pharmacology.org/OSPSuite-R/dev/reference/DefaultPlotConfiguration.html" class="external-link"><code>DefaultPlotConfiguration</code></a>.
To combine multiple plots into a multi-panel figure, create a
<code>PlotGridConfiguration</code> object, add plots to it, and plot
with the <code><a href="https://rdrr.io/pkg/tlf/man/plotGrid.html" class="external-link">plotGrid()</a></code> method. Finally, to export a plot to a
file (e.g., <code>PNG</code> or <code>PDF</code>), use an
<code>ExportConfiguration</code> object.</p>
<p>To use configurations with a similar look and feel in the different
<code>esqLABS</code> projects, create the configurations using the
following functions:</p>
<ul>
<li><a href="https://esqlabs.github.io/esqlabsR/reference/createEsqlabsPlotConfiguration.html"><code>createEsqlabsPlotConfiguration()</code></a></li>
<li><a href="https://esqlabs.github.io/esqlabsR/reference/createEsqlabsPlotGridConfiguration.html"><code>createEsqlabsPlotGridConfiguration()</code></a></li>
<li><a href="https://esqlabs.github.io/esqlabsR/reference/createEsqlabsExportConfiguration.html"><code>createEsqlabsExportConfiguration(projectConfiguration)</code></a></li>
</ul>
<p>For the list of supported properties of the
<code>PlotGirdConfiguration</code>, refer to the <a href="https://www.open-systems-pharmacology.org/TLF-Library/reference/ExportConfiguration.html" class="external-link">reference</a></p>
<p>The next example shows how to create a multi-panel figure using the
default configurations.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotConfig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createEsqlabsPlotConfiguration.html">createEsqlabsPlotConfiguration</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gridConfig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createEsqlabsPlotGridConfiguration.html">createEsqlabsPlotGridConfiguration</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotConfig</span><span class="op">$</span><span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"Time profile"</span></span>
<span><span class="va">indivPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/plotIndividualTimeProfile.html" class="external-link">plotIndividualTimeProfile</a></span><span class="op">(</span><span class="va">dataCombined</span>, defaultPlotConfiguration <span class="op">=</span> <span class="va">plotConfig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotConfig</span><span class="op">$</span><span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"Observed-vs-simulated"</span></span>
<span><span class="va">obsVsSimPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/plotObservedVsSimulated.html" class="external-link">plotObservedVsSimulated</a></span><span class="op">(</span><span class="va">dataCombined</span>, defaultPlotConfiguration <span class="op">=</span> <span class="va">plotConfig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotConfig</span><span class="op">$</span><span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"Res-vs-time"</span></span>
<span><span class="va">resVsTimePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/plotResidualsVsTime.html" class="external-link">plotResidualsVsTime</a></span><span class="op">(</span><span class="va">dataCombined</span>, defaultPlotConfiguration <span class="op">=</span> <span class="va">plotConfig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotConfig</span><span class="op">$</span><span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"Res-vs-simulated"</span></span>
<span><span class="va">resVsSimPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/plotResidualsVsSimulated.html" class="external-link">plotResidualsVsSimulated</a></span><span class="op">(</span><span class="va">dataCombined</span>, defaultPlotConfiguration <span class="op">=</span> <span class="va">plotConfig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gridConfig</span><span class="op">$</span><span class="fu">addPlots</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">indivPlot</span>, <span class="va">obsVsSimPlot</span>, <span class="va">resVsTimePlot</span>, <span class="va">resVsSimPlot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gridConfig</span><span class="op">$</span><span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"All aciclovir plots"</span></span>
<span><span class="va">gridPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tlf/man/plotGrid.html" class="external-link">plotGrid</a></span><span class="op">(</span><span class="va">gridConfig</span><span class="op">)</span></span>
<span><span class="va">gridPlot</span></span></code></pre></div>
<p><img src="esqlabsR-plot-results_files/figure-html/plot-time-profile-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="export-plots-1">Export Plots<a class="anchor" aria-label="anchor" href="#export-plots-1"></a>
</h4>
<p>To save the plot to a <code>PNG</code> file, use the <a href="https://www.open-systems-pharmacology.org/TLF-Library/reference/ExportConfiguration.html" class="external-link"><code>ExportConfiguration</code></a>.
Make sure that the <code>fileName</code> argument ends with
<code>.png</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exportConfig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createEsqlabsExportConfiguration.html">createEsqlabsExportConfiguration</a></span><span class="op">(</span><span class="va">projectConfiguration</span><span class="op">)</span></span>
<span><span class="va">exportConfig</span><span class="op">$</span><span class="fu">savePlot</span><span class="op">(</span><span class="va">gridPlot</span>, fileName <span class="op">=</span> <span class="st">"All plots.png"</span><span class="op">)</span></span></code></pre></div>
<p>By default, the height of the output figure is calculated from the
number of rows in the multi-panel plot and the height defined in
<code>ExportConfiguration$heightPerRow</code>. If you want to define a
fixed height with the parameter <code>ExportConfiguration$height</code>,
set <code>ExportConfiguration$heightPerRow = NULL</code>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="observed-data">Observed Data<a class="anchor" aria-label="anchor" href="#observed-data"></a>
</h2>
<p>Functionalities of <code>esqlabsR</code> require observed data to be
present as <a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/DataSet.html" class="external-link"><code>DataSet</code></a>
objects. Please refer to the article <a href="https://www.open-systems-pharmacology.org/OSPSuite-R/dev/articles/observed-data.html" class="external-link">Observed
data</a> for information on loading data from Excel or
<code>*.pkml</code> files. <a href="https://github.com/esqLABS/esqlabsR" class="external-link">esqlabsR</a> offers a convenience
function <code><a href="../reference/loadObservedData.html">loadObservedData()</a></code> that facilitates loading data
in <code>esqLABS</code> projects. Assuming the standard project folder
structure is followed, and a valid <code>ProjectConfiguration</code>
(see <a href="standard-workflow.html">Standard workflow</a>) and Excel
files with observed data are present in the
<code>projectConfiguration$dataFolder</code> folder, the following code
loads the data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">projectConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDefaultProjectConfiguration.html">createDefaultProjectConfiguration</a></span><span class="op">(</span><span class="fu"><a href="../reference/example_ProjectConfiguration.html">example_ProjectConfiguration</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataSheets</span> <span class="op">&lt;-</span> <span class="st">"Laskin 1982.Group A"</span></span>
<span></span>
<span><span class="va">observedData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadObservedData.html">loadObservedData</a></span><span class="op">(</span></span>
<span>  projectConfiguration <span class="op">=</span> <span class="va">projectConfiguration</span>,</span>
<span>  sheets <span class="op">=</span> <span class="va">dataSheets</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">observedData</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Laskin 1982.Group A_Aciclovir_1_Human_PeripheralVenousBlood_Plasma_2.5 mg/kg_iv_"</span></span></code></pre></div>
<p>The function loads the data from the file
<code>projectConfiguration$dataFile</code> from the folder
<code>projectConfiguration$dataFolder</code> and returns a list of
<code>DataSet</code>objects. The resulting object can be used to plot
results to compare simulated and observed data.</p>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<ul>
<li>At any time, you can check the groups assigned to the datasets in
the <code>DataCombined</code> object by calling the
<code>DataCombined$groupMap</code> or by examining the output of
<code>dataCombined$toDataFrame()</code>.</li>
</ul>
<p>More detailed information on function signatures can be found in the
following:</p>
<ul>
<li>
<code>ospsuite</code> documentation on:
<ul>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/loadDataImporterConfiguration.html" class="external-link">loadDataImporterConfiguration()</a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/DataImporterConfiguration.html" class="external-link">DataImporterConfiguration
class</a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/createImporterConfigurationForFile.html" class="external-link">createImporterConfigurationForFile()</a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/DataSet.html" class="external-link">DataSet
class</a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/dataSetToDataFrame.html" class="external-link">dataSetToDataFrame()</a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/loadDataSetsFromExcel.html" class="external-link">loadDataSetsFromExcel()</a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/loadDataSetFromPKML.html" class="external-link">loadDataSetFromPKML()</a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/saveDataSetToPKML.html" class="external-link">saveDataSetToPKML()</a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/DataCombined.html" class="external-link"><code>DataCombined</code>
class</a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/plotIndividualTimeProfile.html" class="external-link"><code>plotIndividualTimeProfile()</code></a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/plotObservedVsSimulated.html" class="external-link"><code>plotObservedVsSimulated()</code></a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/plotResidualsVsSimulated.html" class="external-link"><code>plotResidualsVsSimulated()</code></a></li>
<li><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/plotResidualsVsTime.html" class="external-link"><code>plotResidualsVsTime()</code></a></li>
</ul>
</li>
<li>
<code>tlf</code> documentation on:
<ul>
<li><a href="https://www.open-systems-pharmacology.org/TLF-Library/reference/PlotGridConfiguration.html" class="external-link"><code>PlotGridConfiguration</code></a></li>
<li><a href="https://www.open-systems-pharmacology.org/TLF-Library/reference/plotGrid.html" class="external-link"><code>plotGrid()</code></a></li>
<li><a href="https://www.open-systems-pharmacology.org/TLF-Library/reference/ExportConfiguration.html" class="external-link"><code>ExportConfiguration</code></a></li>
</ul>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://esqlabs.com/" class="external-link"><img src="https://esqlabs.github.io/esqlabsR/reference/figures/esqlabs.png" style="max-width:33px">esqLABS</a>, Pavel Balazki, Johanna Eitel, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, Sergei Vavilov, <a href="https://github.com/Felixmil" class="external-link">Felix Mil</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
