<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add scenario configurations to project Excel files — addScenarioConfigurationsToExcel • esqlabsR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add scenario configurations to project Excel files — addScenarioConfigurationsToExcel"><meta name="description" content="Adds scenario configurations to the project's Scenarios.xlsx file and ensures
that required application protocol sheets exist in the Applications.xlsx file.
This function handles the Excel file operations for adding scenarios to a project."><meta property="og:description" content="Adds scenario configurations to the project's Scenarios.xlsx file and ensures
that required application protocol sheets exist in the Applications.xlsx file.
This function handles the Excel file operations for adding scenarios to a project."><meta property="og:image" content="https://esqlabs.github.io/esqlabsR/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">esqlabsR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">5.5.0.9008</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/esqlabsR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>esqlabsR Workflow</h6></li>
    <li><a class="dropdown-item" href="../articles/workflow-overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/project-structure.html">1. Initialize a Project</a></li>
    <li><a class="dropdown-item" href="../articles/design-scenarios.html">2. Design Scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/run-simulations.html">3. Run Simulations</a></li>
    <li><a class="dropdown-item" href="../articles/plot-results.html">4. Plot Results</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6></li>
    <li><a class="dropdown-item" href="../articles/presentations.html">Presentations</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity.html">Sensitivity Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity-plots.html">Sensitivity Analysis – Plot Customization</a></li>
    <li><a class="dropdown-item" href="../articles/advanced.html">Advanced Topics</a></li>
    <li><a class="dropdown-item" href="../articles/project-migration-guide.html">Migrating Project Structure Versions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/esqLABS/esqlabsR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add scenario configurations to project Excel files</h1>
      <small class="dont-index">Source: <a href="https://github.com/esqLABS/esqlabsR/blob/main/R/utilities-scenario-configuration.R" class="external-link"><code>R/utilities-scenario-configuration.R</code></a></small>
      <div class="d-none name"><code>addScenarioConfigurationsToExcel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Adds scenario configurations to the project's Scenarios.xlsx file and ensures
that required application protocol sheets exist in the Applications.xlsx file.
This function handles the Excel file operations for adding scenarios to a project.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addScenarioConfigurationsToExcel</span><span class="op">(</span></span>
<span>  <span class="va">scenarioConfigurations</span>,</span>
<span>  <span class="va">projectConfiguration</span>,</span>
<span>  appendToExisting <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-scenarioconfigurations">scenarioConfigurations<a class="anchor" aria-label="anchor" href="#arg-scenarioconfigurations"></a></dt>
<dd><p>Named list of <code>ScenarioConfiguration</code> objects to add to the project.</p></dd>


<dt id="arg-projectconfiguration">projectConfiguration<a class="anchor" aria-label="anchor" href="#arg-projectconfiguration"></a></dt>
<dd><p>A <code>ProjectConfiguration</code> object holding base information.</p></dd>


<dt id="arg-appendtoexisting">appendToExisting<a class="anchor" aria-label="anchor" href="#arg-appendtoexisting"></a></dt>
<dd><p>Logical. Whether to append new scenarios to existing ones in the
scenarios file. If <code>FALSE</code>, the ENTIRE scenarios file will be overwritten with
only the new scenarios. If <code>TRUE</code> (default), new scenarios will be added to existing ones.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns the names of the added scenarios.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs the following operations:</p><ul><li><p>Checks for duplicate scenario names if <code>appendToExisting</code> is <code>TRUE</code>.</p></li>
<li><p>Creates missing application protocol sheets in Applications.xlsx by extracting
parameters from PKML files (both Events and Applications parameters).</p></li>
<li><p>Writes scenario configurations to the Scenarios.xlsx file with proper structure.</p></li>
<li><p>Manages output paths and their IDs in the OutputPaths sheet.</p></li>
</ul><p>The function ensures that the Excel files are properly structured with the following sheets:</p><ul><li><p><strong>Scenarios sheet</strong>: Contains scenario definitions with columns for scenario name,
individual/population IDs, parameter sheets, application protocol, simulation time,
steady state settings, model file, and output path IDs.</p></li>
<li><p><strong>OutputPaths sheet</strong>: Contains output path IDs and their corresponding paths.
When named vectors are used for <code>outputPaths</code> in scenario configurations, the names
will be used as OutputPathId values.</p></li>
<li><p><strong>Applications.xlsx</strong>: Contains application protocol sheets with parameter definitions.</p></li>
</ul><p>The function handles parameter extraction from PKML files, excluding default parameters
like "Volume" and "Application rate", and only includes constant parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create scenario configurations from PKML</span></span></span>
<span class="r-in"><span><span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="createScenarioConfigurationsFromPKML.html">createScenarioConfigurationsFromPKML</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  pkmlFilePaths <span class="op">=</span> <span class="st">"path/to/simulation.pkml"</span>,</span></span>
<span class="r-in"><span>  projectConfiguration <span class="op">=</span> <span class="va">projectConfiguration</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add scenarios to project Excel files</span></span></span>
<span class="r-in"><span><span class="fu">addScenarioConfigurationsToExcel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  scenarioConfigurations <span class="op">=</span> <span class="va">scenarios</span>,</span></span>
<span class="r-in"><span>  projectConfiguration <span class="op">=</span> <span class="va">projectConfiguration</span>,</span></span>
<span class="r-in"><span>  appendToExisting <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://esqlabs.com/" class="external-link"><img src="https://esqlabs.github.io/esqlabsR/reference/figures/circles.png" style="max-width:33px">esqLABS</a>, Pavel Balazki, Johanna Eitel, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, Sergei Vavilov, <a href="https://github.com/Felixmil" class="external-link">Felix Mil</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

