---
title: "template"
subtitle: ""
author: ""
format: 
  esqlabs-html
---

<!-- MAKE SURE TO INSTALL ALL REQUIRED PACKAGES BEFORE RUNNING THIS -->
<!-- USE THE install_packages.R SCRIPT AVAILABLE IN THE CODE FOLDER -->


# Preparation

## Load Libraries

```{r}
library(esqlabsR)
```

## Load Project Configuration

```{r}
projectConfiguration <- createDefaultProjectConfiguration("projectConfiguration.xlsx")
```


## Load Scenarios

```{r}
my_scenarios <- 
  createScenarios(
    readScenarioConfigurationFromExcel( # Read scenarios from excel file
      scenarioNames = "TestScenario", # Import the scenario defined as "TestScenario" 
                                      # in the excel file
      projectConfiguration = projectConfiguration
    )
  )
```


## Run Simulations

```{r}
my_simulation <- runScenarios(
  scenarios = my_scenarios
)
```


## Generate Plots

```{r}
dataSheets <- "Laskin 1982.Group A"
observedData <- loadObservedData(projectConfiguration = projectConfiguration, sheets = dataSheets)

plots <- createPlotsFromExcel(simulatedScenarios = my_simulation,
                              observedData = observedData,
                              plotGridNames = c("Aciclovir", "Aciclovir2"),
                              projectConfiguration = projectConfiguration)

```

# Results

## Simulation Results

```{r}
simulationResultsToTibble(my_simulation$TestScenario$results)
```


## Plots


```{r}
plots$Aciclovir
```

```{r}
plots$Aciclovir2
```




